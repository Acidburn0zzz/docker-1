<!DOCTYPE html>
<html>
<head>
  <title>paths.coffee</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../../../doc-style.css" />
  <script src="../../../../../doc-filelist.js"></script>
  <script>
    var relativeDir = '../../../../../', thisFile = 'node_modules/watchr/node_modules/bal-util/lib/paths.coffee';
  </script>
  <script src="../../../../../doc-script.js"></script>
</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">
    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container"><div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
      <tr>
        <td class="docs">
          <h1>paths.coffee</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1">&#182;</a>
</div>
<p>Requires</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="nv">fs = </span><span class="nx">require</span><span class="p">(</span><span class="s">&#39;fs&#39;</span><span class="p">)</span>
<span class="nv">pathUtil = </span><span class="nx">require</span><span class="p">(</span><span class="s">&#39;path&#39;</span><span class="p">)</span>
<span class="nv">request = </span><span class="kc">null</span>
<span class="nv">balUtilPaths = </span><span class="kc">null</span>
<span class="nv">balUtilFlow = </span><span class="nx">require</span><span class="p">(</span><span class="nx">pathUtil</span><span class="p">.</span><span class="nx">join</span> <span class="nx">__dirname</span><span class="p">,</span> <span class="s">&#39;flow.coffee&#39;</span><span class="p">)</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2">&#182;</a>
</div>
<p>Create a counter of all the open files we have
As the filesystem will throw a fatal error if we have too many open files</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="nx">global</span><span class="p">.</span><span class="nx">numberOfOpenFiles</span> <span class="o">?=</span> <span class="mi">0</span>
<span class="nx">global</span><span class="p">.</span><span class="nx">maxNumberOfOpenFiles</span> <span class="o">?=</span> <span class="mi">500</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3">&#182;</a>
</div>
<p>=====================================
Paths</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="nv">balUtilPaths =</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4">&#182;</a>
</div>
<p>=====================================
Open and Close Files</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5">&#182;</a>
</div>
<p>Allows us to open files safely
by tracking the amount of open files we have</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6">&#182;</a>
</div>
<p>Open a file
Pass your callback to fire when it is safe to open the file</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="nv">openFile: </span><span class="nf">(next) -&gt;</span>
    <span class="k">if</span> <span class="nx">global</span><span class="p">.</span><span class="nx">numberOfOpenFiles</span> <span class="o">&gt;=</span> <span class="nx">global</span><span class="p">.</span><span class="nx">maxNumberOfOpenFiles</span>
      <span class="nx">setTimeout</span><span class="p">(</span>
        <span class="o">-&gt;</span>
          <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">openFile</span><span class="p">(</span><span class="nx">next</span><span class="p">)</span>
        <span class="p">,</span><span class="mi">50</span>
      <span class="p">)</span>
    <span class="k">else</span>
      <span class="o">++</span><span class="nx">global</span><span class="p">.</span><span class="nx">numberOfOpenFiles</span>
      <span class="nx">next</span><span class="o">?</span><span class="p">()</span>
    <span class="nx">@</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7">&#182;</a>
</div>
<p>Close a file
Call this once you are done with that file</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="nv">closeFile: </span><span class="nf">(next) -&gt;</span>
    <span class="o">--</span><span class="nx">global</span><span class="p">.</span><span class="nx">numberOfOpenFiles</span>
    <span class="nx">next</span><span class="o">?</span><span class="p">()</span>
    <span class="nx">@</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8">&#182;</a>
</div>
<p>=====================================
Our Extensions</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9">&#182;</a>
</div>
<p>Copy a file
Or rather overwrite a file, regardless of whether or not it was existing before
next(err)</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="nv">cp: </span><span class="nf">(src,dst,next) -&gt;</span>
    <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">openFile</span> <span class="o">-&gt;</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span> <span class="nx">src</span><span class="p">,</span> <span class="s">&#39;binary&#39;</span><span class="p">,</span> <span class="nf">(err,data) -&gt;</span>
      <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">closeFile</span><span class="p">()</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10">&#182;</a>
</div>
<p>Error</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>      <span class="k">if</span> <span class="nx">err</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&#39;balUtilPaths.cp: cp failed on:&#39;</span><span class="p">,</span><span class="nx">src</span>
        <span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11">&#182;</a>
</div>
<p>Success</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>      <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">openFile</span> <span class="o">-&gt;</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">writeFile</span> <span class="nx">dst</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="s">&#39;binary&#39;</span><span class="p">,</span> <span class="nf">(err) -&gt;</span>
        <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">closeFile</span><span class="p">()</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12">&#182;</a>
</div>
<p>Forward</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>        <span class="k">if</span> <span class="nx">err</span>
          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&#39;balUtilPaths.cp: writeFile failed on:&#39;</span><span class="p">,</span><span class="nx">dst</span>
        <span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13">&#182;</a>
</div>
<p>Chain</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="nx">@</span>
  </pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-14" id="section-14">&#182;</a>
</div>
<p>Get the parent path</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="nv">getParentPathSync: </span><span class="nf">(p) -&gt;</span>
    <span class="nv">parentPath = </span><span class="nx">p</span><span class="p">.</span><span class="nx">replace</span> <span class="sr">/[\/\\][^\/\\]+$/</span><span class="p">,</span> <span class="s">&#39;&#39;</span>
    <span class="k">return</span> <span class="nx">parentPath</span>
  </pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-15" id="section-15">&#182;</a>
</div>
<p>Ensure path exists
next(err)</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="nv">ensurePath: </span><span class="nf">(p,next) -&gt;</span>
    <span class="nv">p = </span><span class="nx">p</span><span class="p">.</span><span class="nx">replace</span> <span class="sr">/[\/\\]$/</span><span class="p">,</span> <span class="s">&#39;&#39;</span>
    <span class="nx">pathUtil</span><span class="p">.</span><span class="nx">exists</span> <span class="nx">p</span><span class="p">,</span> <span class="nf">(exists) -&gt;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-16" id="section-16">&#182;</a>
</div>
<p>Error </p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>      <span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">()</span>  <span class="k">if</span> <span class="nx">exists</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-17" id="section-17">&#182;</a>
</div>
<p>Success</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>      <span class="nv">parentPath = </span><span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">getParentPathSync</span> <span class="nx">p</span>
      <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">ensurePath</span> <span class="nx">parentPath</span><span class="p">,</span> <span class="nf">(err) -&gt;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-18" id="section-18">&#182;</a>
</div>
<p>Error</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>        <span class="k">if</span> <span class="nx">err</span>
          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&#39;balUtilPaths.ensurePath: failed to ensure the path:&#39;</span><span class="p">,</span><span class="nx">parentPath</span>
          <span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-19" id="section-19">&#182;</a>
</div>
<p>Success</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>        <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">openFile</span> <span class="o">-&gt;</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">mkdir</span> <span class="nx">p</span><span class="p">,</span> <span class="s">&#39;700&#39;</span><span class="p">,</span> <span class="nf">(err) -&gt;</span>
          <span class="nx">pathUtil</span><span class="p">.</span><span class="nx">exists</span> <span class="nx">p</span><span class="p">,</span> <span class="nf">(exists) -&gt;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-20" id="section-20">&#182;</a>
</div>
<p>Close</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>            <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">closeFile</span><span class="p">()</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-21" id="section-21">&#182;</a>
</div>
<p>Error</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>            <span class="k">if</span> <span class="o">not</span> <span class="nx">exists</span>
              <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&#39;balUtilPaths.ensurePath: failed to create the directory:&#39;</span><span class="p">,</span><span class="nx">p</span>
              <span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="k">new</span> <span class="nb">Error</span> <span class="s">&#39;Failed to create the directory &#39;</span><span class="o">+</span><span class="nx">p</span><span class="p">)</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-22" id="section-22">&#182;</a>
</div>
<p>Success</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>            <span class="nx">next</span><span class="o">?</span><span class="p">()</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-23" id="section-23">&#182;</a>
</div>
<p>Chain</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="nx">@</span>
  </pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-24" id="section-24">&#182;</a>
</div>
<p>Prefix path</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="nv">prefixPathSync: </span><span class="nf">(path,parentPath) -&gt;</span>
    <span class="nv">path = </span><span class="nx">path</span><span class="p">.</span><span class="nx">replace</span> <span class="sr">/[\/\\]$/</span><span class="p">,</span> <span class="s">&#39;&#39;</span>
    <span class="k">if</span> <span class="sr">/^([a-zA-Z]\:|\/)/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span> <span class="o">is</span> <span class="kc">false</span>
      <span class="nv">path = </span><span class="nx">pathUtil</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">parentPath</span><span class="p">,</span><span class="nx">path</span><span class="p">)</span>
    <span class="k">return</span> <span class="nx">path</span>
  </pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-25" id="section-25">&#182;</a>
</div>
<p>Is it a directory?
next(err,isDirectory,fileStat)</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="nv">isDirectory: </span><span class="nf">(fileFullPath,next) -&gt;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-26" id="section-26">&#182;</a>
</div>
<p>Stat</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">openFile</span> <span class="o">-&gt;</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">stat</span> <span class="nx">fileFullPath</span><span class="p">,</span> <span class="nf">(err,fileStat) -&gt;</span>
      <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">closeFile</span><span class="p">()</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-27" id="section-27">&#182;</a>
</div>
<p>Error</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>      <span class="k">if</span> <span class="nx">err</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&#39;balUtilPaths.isDirectory: stat failed on:&#39;</span><span class="p">,</span><span class="nx">fileFullPath</span>
        <span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-28" id="section-28">&#182;</a>
</div>
<p>Success</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>      <span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">fileStat</span><span class="p">.</span><span class="nx">isDirectory</span><span class="p">(),</span> <span class="nx">fileStat</span><span class="p">)</span>
    </pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-29" id="section-29">&#182;</a>
</div>
<p>Chain</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="nx">@</span>
  
  </pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-30" id="section-30">&#182;</a>
</div>
<p>Generate a slug for a file</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="nv">generateSlugSync: </span><span class="nf">(fileFullPath) -&gt;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-31" id="section-31">&#182;</a>
</div>
<p>Slugify</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="nv">result = </span><span class="nx">fileFullPath</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/[^a-zA-Z0-9]/g</span><span class="p">,</span><span class="s">&#39;-&#39;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^-/</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/-+/</span><span class="p">,</span><span class="s">&#39;-&#39;</span><span class="p">)</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-32" id="section-32">&#182;</a>
</div>
<p>Return</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="k">return</span> <span class="nx">result</span>
    </pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-33" id="section-33">&#182;</a>
</div>
<p>Scan a directory into a tree
next(err,tree)</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="nv">scantree: </span><span class="nf">(dirPath,next) -&gt;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-34" id="section-34">&#182;</a>
</div>
<p>Handle</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">scandir</span><span class="p">(</span>
      <span class="nv">path: </span><span class="nx">dirPath</span>
      <span class="nv">readFiles: </span><span class="kc">true</span>
      <span class="nv">ignoreHiddenFiles: </span><span class="kc">true</span>
      <span class="nv">next: </span><span class="nf">(err,list,tree) -&gt;</span>
        <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="nx">tree</span><span class="p">)</span>
    <span class="p">)</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-35" id="section-35">&#182;</a>
</div>
<p>Chain</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="nx">@</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-36" id="section-36">&#182;</a>
</div>
<p>Common Ignore Patterns
These are files are directories commonly ignored when it comes with dealing with paths</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="nv">commonIgnorePatterns: </span><span class="sr">/^(\~|(\.(svn|git|hg|DS_Store))|node_modules|CVS|thumbs\.db|desktop\.ini)$/i</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-37" id="section-37">&#182;</a>
</div>
<p>Recursively scan a directory
Usage:
scandir(path,action,fileAction,dirAction,next)
scandir({path,action,fileAction,dirAction,next,stat,recurse,readFiles,ignoreHiddenFiles,ignorePatterns})
Options:
path: the path you want to read
action: null, or a function to use for both the fileAction and dirACtion
fileAction: null, or a function to run against each file, in the following format:
    fileAction(fileFullPath,fileRelativePath,next(err,skip),fileStat)
dirAction: null, or a function to run against each directory, in the following format:
    dirAction(fileFullPath,fileRelativePath,next(err,skip),fileStat)
next: null, or a function to run after the entire directory has been scanned, in the following format:
    next(err,list,tree)
stat: null, or a file stat object for the path if we already have one
recurse: null, or a boolean for whether or not to scan subdirectories too
readFiles: null, or a boolean for whether or not we should read the file contents
ignoreHiddenFiles: null, or a boolean for if we should ignore files starting with a dot
ignorePatterns: null, or true (if true will use balUtilPaths.commonIgnorePatterns),
    or a regex to match paths against to determine if we should ignore them
Next Callback Arguments:
err: null, or an error that has occured
list: a collection of all the child nodes in a list/object format:
    {fileRelativePath: 'dir|file'}
tree: a colleciton of all the child nodes in a tree format:
    {dir:{dir:{},file1:true}}
    if the readFiles option is true, then files will be returned with their contents instead</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="nv">scandir: </span><span class="nf">(args...) -&gt;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-38" id="section-38">&#182;</a>
</div>
<p>Prepare </p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="nv">list = </span><span class="p">{}</span>
    <span class="nv">tree = </span><span class="p">{}</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-39" id="section-39">&#182;</a>
</div>
<p>Arguments</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="k">if</span> <span class="nx">args</span><span class="p">.</span><span class="nx">length</span> <span class="o">is</span> <span class="mi">1</span>
      <span class="nv">options = </span><span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span> <span class="k">if</span> <span class="nx">args</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;=</span> <span class="mi">4</span>
      <span class="nv">options =</span>
        <span class="nv">path: </span><span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="nv">fileAction: </span><span class="nx">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">or</span> <span class="kc">null</span>
        <span class="nv">dirAction: </span><span class="nx">args</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">or</span> <span class="kc">null</span>
        <span class="nv">next: </span><span class="nx">args</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">or</span> <span class="kc">null</span>
    <span class="k">else</span>
      <span class="nv">err = </span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s">&#39;balUtilPaths.scandir: unsupported arguments&#39;</span><span class="p">)</span>
      <span class="k">if</span> <span class="nx">next</span>
        <span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
      <span class="k">else</span>
        <span class="k">throw</span> <span class="nx">err</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-40" id="section-40">&#182;</a>
</div>
<p>Prepare defaults</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="nx">options</span><span class="p">.</span><span class="nx">recurse</span> <span class="o">?=</span> <span class="kc">true</span>
    <span class="nx">options</span><span class="p">.</span><span class="nx">readFiles</span> <span class="o">?=</span> <span class="kc">false</span>
    <span class="nx">options</span><span class="p">.</span><span class="nx">ignoreHiddenFiles</span> <span class="o">?=</span> <span class="kc">false</span>
    <span class="nx">options</span><span class="p">.</span><span class="nx">ignorePatterns</span> <span class="o">?=</span> <span class="kc">false</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-41" id="section-41">&#182;</a>
</div>
<p>Action</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="k">if</span> <span class="nx">options</span><span class="p">.</span><span class="nx">action</span><span class="o">?</span>
      <span class="nx">options</span><span class="p">.</span><span class="nx">fileAction</span> <span class="o">?=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">action</span>
      <span class="nx">options</span><span class="p">.</span><span class="nx">dirAction</span> <span class="o">?=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">action</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-42" id="section-42">&#182;</a>
</div>
<p>Ignore Patterns</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="k">if</span> <span class="nx">options</span><span class="p">.</span><span class="nx">ignorePatterns</span> <span class="o">is</span> <span class="kc">true</span>
      <span class="nv">options.ignorePatterns = </span><span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">commonIgnorePatterns</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-43" id="section-43">&#182;</a>
</div>
<p>Check needed</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="k">if</span> <span class="nx">options</span><span class="p">.</span><span class="nx">parentPath</span> <span class="o">and</span> <span class="o">!</span><span class="nx">options</span><span class="p">.</span><span class="nx">path</span>
      <span class="nv">options.path = </span><span class="nx">options</span><span class="p">.</span><span class="nx">parentPath</span>
    <span class="k">if</span> <span class="o">!</span><span class="nx">options</span><span class="p">.</span><span class="nx">path</span>
      <span class="nv">err = </span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s">&#39;balUtilPaths.scandir: path is needed&#39;</span><span class="p">)</span>
      <span class="k">if</span> <span class="nx">next</span>
        <span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
      <span class="k">else</span>
        <span class="k">throw</span> <span class="nx">err</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-44" id="section-44">&#182;</a>
</div>
<p>Group</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="nv">tasks = </span><span class="k">new</span> <span class="nx">balUtilFlow</span><span class="p">.</span><span class="nx">Group</span> <span class="nf">(err) -&gt;</span>
      <span class="k">return</span> <span class="nx">options</span><span class="p">.</span><span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">list</span><span class="p">,</span> <span class="nx">tree</span><span class="p">)</span>
    </pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-45" id="section-45">&#182;</a>
</div>
<p>Cycle</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">openFile</span> <span class="o">-&gt;</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">readdir</span> <span class="nx">options</span><span class="p">.</span><span class="nx">path</span><span class="p">,</span> <span class="nf">(err,files) -&gt;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-46" id="section-46">&#182;</a>
</div>
<p>Close</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>      <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">closeFile</span><span class="p">()</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-47" id="section-47">&#182;</a>
</div>
<p>Checks</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>      <span class="k">if</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">exited</span>
        <span class="k">return</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-48" id="section-48">&#182;</a>
</div>
<p>Error</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>      <span class="k">else</span> <span class="k">if</span> <span class="nx">err</span>
        <span class="nx">debugger</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&#39;balUtilPaths.scandir: readdir has failed on:&#39;</span><span class="p">,</span> <span class="nx">options</span><span class="p">.</span><span class="nx">path</span>
        <span class="k">return</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
      </pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-49" id="section-49">&#182;</a>
</div>
<p>Totals</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>      <span class="nx">tasks</span><span class="p">.</span><span class="nx">total</span> <span class="o">+=</span> <span class="nx">files</span><span class="p">.</span><span class="nx">length</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-50" id="section-50">&#182;</a>
</div>
<p>Empty?</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>      <span class="k">if</span> <span class="o">!</span><span class="nx">files</span><span class="p">.</span><span class="nx">length</span>
        <span class="k">return</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">exit</span><span class="p">()</span>
      </pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-51" id="section-51">&#182;</a>
</div>
<p>Cycle</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>      <span class="k">else</span> <span class="nx">files</span><span class="p">.</span><span class="nx">forEach</span> <span class="nf">(file) -&gt;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-52" id="section-52">&#182;</a>
</div>
<p>Check</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>        <span class="nv">isHiddenFile = </span><span class="nx">options</span><span class="p">.</span><span class="nx">ignoreHiddenFiles</span> <span class="o">and</span> <span class="sr">/^\./</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">file</span><span class="p">)</span>
        <span class="nv">isIgnoredFile = </span><span class="nx">options</span><span class="p">.</span><span class="nx">ignorePatterns</span> <span class="o">and</span> <span class="nx">options</span><span class="p">.</span><span class="nx">ignorePatterns</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">file</span><span class="p">)</span>
        <span class="k">if</span> <span class="nx">isHiddenFile</span> <span class="o">or</span> <span class="nx">isIgnoredFile</span>
          <span class="k">return</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">complete</span><span class="p">()</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-53" id="section-53">&#182;</a>
</div>
<p>Prepare</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>        <span class="nv">fileFullPath = </span><span class="nx">pathUtil</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">path</span><span class="p">,</span><span class="nx">file</span><span class="p">)</span>
        <span class="nv">fileRelativePath =</span>
          <span class="k">if</span> <span class="nx">options</span><span class="p">.</span><span class="nx">relativePath</span>
            <span class="nx">pathUtil</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">relativePath</span><span class="p">,</span><span class="nx">file</span><span class="p">)</span>
          <span class="k">else</span>
            <span class="nx">file</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-54" id="section-54">&#182;</a>
</div>
<p>IsDirectory</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>        <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">isDirectory</span> <span class="nx">fileFullPath</span><span class="p">,</span> <span class="nf">(err,isDirectory,fileStat) -&gt;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-55" id="section-55">&#182;</a>
</div>
<p>Check</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>          <span class="k">if</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">exited</span>
            <span class="k">return</span>
          </pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-56" id="section-56">&#182;</a>
</div>
<p>Error</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>          <span class="k">else</span> <span class="k">if</span> <span class="nx">err</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&#39;balUtilPaths.scandir: isDirectory has failed on:&#39;</span><span class="p">,</span> <span class="nx">fileFullPath</span>
            <span class="k">return</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
          </pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-57" id="section-57">&#182;</a>
</div>
<p>Directory</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>          <span class="k">else</span> <span class="k">if</span> <span class="nx">isDirectory</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-58" id="section-58">&#182;</a>
</div>
<p>Prepare</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>            <span class="nv">complete = </span><span class="nf">(err,skip,subtreeCallback) -&gt;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-59" id="section-59">&#182;</a>
</div>
<p>Error</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>              <span class="k">return</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>  <span class="k">if</span> <span class="nx">err</span>
        </pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-60" id="section-60">&#182;</a>
</div>
<p>Exited</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>              <span class="k">return</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">exit</span><span class="p">()</span>  <span class="k">if</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">exited</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-61" id="section-61">&#182;</a>
</div>
<p>Handle</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>              <span class="k">if</span> <span class="nx">skip</span> <span class="o">isnt</span> <span class="kc">true</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-62" id="section-62">&#182;</a>
</div>
<p>Append</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>                <span class="nx">list</span><span class="p">[</span><span class="nx">fileRelativePath</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;dir&#39;</span>
                <span class="nx">tree</span><span class="p">[</span><span class="nx">file</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-63" id="section-63">&#182;</a>
</div>
<p>No Recurse</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>                <span class="nx">unless</span> <span class="nx">options</span><span class="p">.</span><span class="nx">recurse</span>
                  <span class="k">return</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">complete</span><span class="p">()</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-64" id="section-64">&#182;</a>
</div>
<p>Recurse</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>                <span class="k">else</span>
                  <span class="k">return</span> <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">scandir</span><span class="p">(</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-65" id="section-65">&#182;</a>
</div>
<p>Path</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>                    <span class="nv">path: </span><span class="nx">fileFullPath</span>
                    <span class="nv">relativePath: </span><span class="nx">fileRelativePath</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-66" id="section-66">&#182;</a>
</div>
<p>Options</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>                    <span class="nv">fileAction: </span><span class="nx">options</span><span class="p">.</span><span class="nx">fileAction</span>
                    <span class="nv">dirAction: </span><span class="nx">options</span><span class="p">.</span><span class="nx">dirAction</span>
                    <span class="nv">readFiles: </span><span class="nx">options</span><span class="p">.</span><span class="nx">readFiles</span>
                    <span class="nv">ignorePatterns: </span><span class="nx">options</span><span class="p">.</span><span class="nx">ignorePatterns</span>
                    <span class="nv">ignoreHiddenFiles: </span><span class="nx">options</span><span class="p">.</span><span class="nx">ignoreHiddenFiles</span>
                    <span class="nv">recurse: </span><span class="nx">options</span><span class="p">.</span><span class="nx">recurse</span>
                    <span class="nv">stat: </span><span class="nx">options</span><span class="p">.</span><span class="nx">fileStat</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-67" id="section-67">&#182;</a>
</div>
<p>Completed</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>                    <span class="nv">next: </span><span class="nf">(err,_list,_tree) -&gt;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-68" id="section-68">&#182;</a>
</div>
<p>Merge in children of the parent directory</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>                      <span class="nx">tree</span><span class="p">[</span><span class="nx">file</span><span class="p">]</span> <span class="o">=</span> <span class="nx">_tree</span>
                      <span class="k">for</span> <span class="nx">own</span> <span class="nx">filePath</span><span class="p">,</span> <span class="nx">fileType</span> <span class="k">of</span> <span class="nx">_list</span>
                        <span class="nx">list</span><span class="p">[</span><span class="nx">filePath</span><span class="p">]</span> <span class="o">=</span> <span class="nx">fileType</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-69" id="section-69">&#182;</a>
</div>
<p>Exited</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>                      <span class="k">if</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">exited</span>
                        <span class="k">return</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">exit</span><span class="p">()</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-70" id="section-70">&#182;</a>
</div>
<p>Error</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>                      <span class="k">else</span> <span class="k">if</span> <span class="nx">err</span>
                        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&#39;balUtilPaths.scandir: has failed on:&#39;</span><span class="p">,</span> <span class="nx">fileFullPath</span>
                        <span class="k">return</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-71" id="section-71">&#182;</a>
</div>
<p>Subtree</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>                      <span class="k">else</span> <span class="k">if</span> <span class="nx">subtreeCallback</span>
                        <span class="k">return</span> <span class="nx">subtreeCallback</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">completer</span><span class="p">()</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-72" id="section-72">&#182;</a>
</div>
<p>Complete</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>                      <span class="k">else</span>
                        <span class="k">return</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">complete</span><span class="p">()</span>
                  <span class="p">)</span>
              
              <span class="k">else</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-73" id="section-73">&#182;</a>
</div>
<p>Done</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>                <span class="k">return</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">complete</span><span class="p">()</span>
            </pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-74" id="section-74">&#182;</a>
</div>
<p>Action</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>            <span class="k">if</span> <span class="nx">options</span><span class="p">.</span><span class="nx">dirAction</span>
              <span class="k">return</span> <span class="nx">options</span><span class="p">.</span><span class="nx">dirAction</span><span class="p">(</span><span class="nx">fileFullPath</span><span class="p">,</span> <span class="nx">fileRelativePath</span><span class="p">,</span> <span class="nx">complete</span><span class="p">,</span> <span class="nx">fileStat</span><span class="p">)</span>
            <span class="k">else</span> <span class="k">if</span> <span class="nx">options</span><span class="p">.</span><span class="nx">dirAction</span> <span class="o">is</span> <span class="kc">false</span>
              <span class="k">return</span> <span class="nx">complete</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="kc">true</span><span class="p">)</span>
            <span class="k">else</span>
              <span class="k">return</span> <span class="nx">complete</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="kc">false</span><span class="p">)</span>
          </pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-75" id="section-75">&#182;</a>
</div>
<p>File</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>          <span class="k">else</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-76" id="section-76">&#182;</a>
</div>
<p>Prepare</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>            <span class="nv">complete = </span><span class="nf">(err,skip) -&gt;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-77" id="section-77">&#182;</a>
</div>
<p>Error</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>              <span class="k">return</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>  <span class="k">if</span> <span class="nx">err</span>
              </pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-78" id="section-78">&#182;</a>
</div>
<p>Exited</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>              <span class="k">return</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">exit</span><span class="p">()</span>  <span class="k">if</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">exited</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-79" id="section-79">&#182;</a>
</div>
<p>Handle</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>              <span class="k">if</span> <span class="nx">skip</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-80" id="section-80">&#182;</a>
</div>
<p>Done</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>                <span class="k">return</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">complete</span><span class="p">()</span>
              <span class="k">else</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-81" id="section-81">&#182;</a>
</div>
<p>Append</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>                <span class="nx">list</span><span class="p">[</span><span class="nx">fileRelativePath</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;file&#39;</span>
                <span class="k">if</span> <span class="nx">options</span><span class="p">.</span><span class="nx">readFiles</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-82" id="section-82">&#182;</a>
</div>
<p>Read file</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>                  <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">openFile</span> <span class="o">-&gt;</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span> <span class="nx">fileFullPath</span><span class="p">,</span> <span class="nf">(err,data) -&gt;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-83" id="section-83">&#182;</a>
</div>
<p>Close file</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>                    <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">closeFile</span><span class="p">()</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-84" id="section-84">&#182;</a>
</div>
<p>Error?</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>                    <span class="k">return</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>  <span class="k">if</span> <span class="nx">err</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-85" id="section-85">&#182;</a>
</div>
<p>Append</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>                    <span class="nx">tree</span><span class="p">[</span><span class="nx">file</span><span class="p">]</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-86" id="section-86">&#182;</a>
</div>
<p>Done</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>                    <span class="k">return</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">complete</span><span class="p">()</span>
                <span class="k">else</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-87" id="section-87">&#182;</a>
</div>
<p>Append</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>                  <span class="nx">tree</span><span class="p">[</span><span class="nx">file</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-88" id="section-88">&#182;</a>
</div>
<p>Done</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>                  <span class="k">return</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">complete</span><span class="p">()</span>
            </pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-89" id="section-89">&#182;</a>
</div>
<p>Action</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>            <span class="k">if</span> <span class="nx">options</span><span class="p">.</span><span class="nx">fileAction</span>
              <span class="k">return</span> <span class="nx">options</span><span class="p">.</span><span class="nx">fileAction</span><span class="p">(</span><span class="nx">fileFullPath</span><span class="p">,</span> <span class="nx">fileRelativePath</span><span class="p">,</span> <span class="nx">complete</span><span class="p">,</span> <span class="nx">fileStat</span><span class="p">)</span>
            <span class="k">else</span> <span class="k">if</span> <span class="nx">options</span><span class="p">.</span><span class="nx">fileAction</span> <span class="o">is</span> <span class="kc">false</span>
              <span class="k">return</span> <span class="nx">complete</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="kc">true</span><span class="p">)</span>
            <span class="k">else</span>
              <span class="k">return</span> <span class="nx">complete</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="kc">false</span><span class="p">)</span>
    </pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-90" id="section-90">&#182;</a>
</div>
<p>Chain</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="nx">@</span>
  </pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-91" id="section-91">&#182;</a>
</div>
<p>Copy a directory
If the same file already exists, we will keep the source one
Usage:
    cpdir({srcPath,outPath,next,[ignoreHiddenFiles],[ignorePatterns]})
    cpdir(srcPath,outPath,next)
Callbacks:
    next(err)</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="nv">cpdir: </span><span class="nf">(args...) -&gt;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-92" id="section-92">&#182;</a>
</div>
<p>Prepare</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="k">if</span> <span class="nx">args</span><span class="p">.</span><span class="nx">length</span> <span class="o">is</span> <span class="mi">1</span>
      <span class="p">{</span><span class="nx">srcPath</span><span class="p">,</span><span class="nx">outPath</span><span class="p">,</span><span class="nx">next</span><span class="p">,</span><span class="nx">ignoreHiddenFiles</span><span class="p">,</span><span class="nx">ignorePatterns</span><span class="p">}</span> <span class="o">=</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span> <span class="k">if</span> <span class="nx">args</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;=</span> <span class="mi">3</span>
      <span class="p">[</span><span class="nx">srcPath</span><span class="p">,</span><span class="nx">outPath</span><span class="p">,</span><span class="nx">next</span><span class="p">]</span> <span class="o">=</span> <span class="nx">args</span>
    <span class="k">else</span>
      <span class="nv">err = </span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s">&#39;balUtilPaths.cpdir: unknown arguments&#39;</span><span class="p">)</span>
      <span class="k">if</span> <span class="nx">next</span>
        <span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
      <span class="k">else</span>
        <span class="k">throw</span> <span class="nx">err</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-93" id="section-93">&#182;</a>
</div>
<p>Create options</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="nv">scandirOptions = </span><span class="p">{</span>
      <span class="nv">path: </span><span class="nx">srcPath</span>
      <span class="nv">fileAction: </span><span class="nf">(fileSrcPath,fileRelativePath,next) -&gt;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-94" id="section-94">&#182;</a>
</div>
<p>Prepare</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>        <span class="nv">fileOutPath = </span><span class="nx">pathUtil</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">outPath</span><span class="p">,</span><span class="nx">fileRelativePath</span><span class="p">)</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-95" id="section-95">&#182;</a>
</div>
<p>Ensure the directory that the file is going to exists</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>        <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">ensurePath</span> <span class="nx">pathUtil</span><span class="p">.</span><span class="nx">dirname</span><span class="p">(</span><span class="nx">fileOutPath</span><span class="p">),</span> <span class="nf">(err) -&gt;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-96" id="section-96">&#182;</a>
</div>
<p>Error</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>          <span class="k">if</span> <span class="nx">err</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&#39;balUtilPaths.cpdir: failed to create the path for the file:&#39;</span><span class="p">,</span><span class="nx">fileSrcPath</span>
            <span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-97" id="section-97">&#182;</a>
</div>
<p>The directory now does exist
So let's now place the file inside it</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>          <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">cp</span> <span class="nx">fileSrcPath</span><span class="p">,</span> <span class="nx">fileOutPath</span><span class="p">,</span> <span class="nf">(err) -&gt;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-98" id="section-98">&#182;</a>
</div>
<p>Forward</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>            <span class="k">if</span> <span class="nx">err</span>
              <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&#39;balUtilPaths.cpdir: failed to copy the child file:&#39;</span><span class="p">,</span><span class="nx">fileSrcPath</span>
            <span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
      <span class="nv">next: </span><span class="nx">next</span>
    <span class="p">}</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-99" id="section-99">&#182;</a>
</div>
<p>Extra options</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="k">if</span> <span class="nx">ignoreHiddenFiles</span><span class="o">?</span>
      <span class="nv">scandirOptions.ignoreHiddenFiles = </span><span class="nx">ignoreHiddenFiles</span>
    <span class="k">if</span> <span class="nx">ignorePatterns</span><span class="o">?</span>
      <span class="nv">scandirOptions.ignorePatterns = </span><span class="nx">ignorePatterns</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-100" id="section-100">&#182;</a>
</div>
<p>Scan all the files in the diretory and copy them over asynchronously</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">scandir</span><span class="p">(</span><span class="nx">scandirOptions</span><span class="p">)</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-101" id="section-101">&#182;</a>
</div>
<p>Chain</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="nx">@</span>
  </pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-102" id="section-102">&#182;</a>
</div>
<p>Replace a directory
If the same file already exists, we will keep the newest one
Usage:
    rpdir({srcPath,outPath,next,[ignoreHiddenFiles],[ignorePatterns]})
    rpdir(srcPath,outPath,next)
Callbacks:
    next(err)</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="nv">rpdir: </span><span class="nf">(args...) -&gt;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-103" id="section-103">&#182;</a>
</div>
<p>Prepare</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="k">if</span> <span class="nx">args</span><span class="p">.</span><span class="nx">length</span> <span class="o">is</span> <span class="mi">1</span>
      <span class="p">{</span><span class="nx">srcPath</span><span class="p">,</span><span class="nx">outPath</span><span class="p">,</span><span class="nx">next</span><span class="p">,</span><span class="nx">ignoreHiddenFiles</span><span class="p">,</span><span class="nx">ignorePatterns</span><span class="p">}</span> <span class="o">=</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span> <span class="k">if</span> <span class="nx">args</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;=</span> <span class="mi">3</span>
      <span class="p">[</span><span class="nx">srcPath</span><span class="p">,</span><span class="nx">outPath</span><span class="p">,</span><span class="nx">next</span><span class="p">]</span> <span class="o">=</span> <span class="nx">args</span>
    <span class="k">else</span>
      <span class="nv">err = </span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s">&#39;balUtilPaths.cpdir: unknown arguments&#39;</span><span class="p">)</span>
      <span class="k">if</span> <span class="nx">next</span>
        <span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
      <span class="k">else</span>
        <span class="k">throw</span> <span class="nx">err</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-104" id="section-104">&#182;</a>
</div>
<p>Create options</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="nv">scandirOptions = </span><span class="p">{</span>
      <span class="nv">path: </span><span class="nx">srcPath</span>
      <span class="nv">fileAction: </span><span class="nf">(fileSrcPath,fileRelativePath,next) -&gt;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-105" id="section-105">&#182;</a>
</div>
<p>Prepare</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>        <span class="nv">fileOutPath = </span><span class="nx">pathUtil</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">outPath</span><span class="p">,</span><span class="nx">fileRelativePath</span><span class="p">)</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-106" id="section-106">&#182;</a>
</div>
<p>Ensure the directory that the file is going to exists</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>        <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">ensurePath</span> <span class="nx">pathUtil</span><span class="p">.</span><span class="nx">dirname</span><span class="p">(</span><span class="nx">fileOutPath</span><span class="p">),</span> <span class="nf">(err) -&gt;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-107" id="section-107">&#182;</a>
</div>
<p>Error</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>          <span class="k">if</span> <span class="nx">err</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&#39;balUtilPaths.rpdir: failed to create the path for the file:&#39;</span><span class="p">,</span><span class="nx">fileSrcPath</span>
            <span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-108" id="section-108">&#182;</a>
</div>
<p>Check if it is worthwhile copying that file</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>          <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">isPathOlderThan</span> <span class="nx">fileOutPath</span><span class="p">,</span> <span class="nx">fileSrcPath</span><span class="p">,</span> <span class="nf">(err,older) -&gt;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-109" id="section-109">&#182;</a>
</div>
<p>The src path has been modified since the out path was generated</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>            <span class="k">if</span> <span class="nx">older</span> <span class="o">is</span> <span class="kc">true</span> <span class="o">or</span> <span class="nx">older</span> <span class="o">is</span> <span class="kc">null</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-110" id="section-110">&#182;</a>
</div>
<p>The directory now does exist
So let's now place the file inside it</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>              <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">cp</span> <span class="nx">fileSrcPath</span><span class="p">,</span> <span class="nx">fileOutPath</span><span class="p">,</span> <span class="nf">(err) -&gt;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-111" id="section-111">&#182;</a>
</div>
<p>Forward</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>                <span class="k">if</span> <span class="nx">err</span>
                  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&#39;balUtilPaths.rpdir: failed to copy the child file:&#39;</span><span class="p">,</span><span class="nx">fileSrcPath</span>
                <span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-112" id="section-112">&#182;</a>
</div>
<p>The out path is new enough</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>            <span class="k">else</span>
              <span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">()</span>
      <span class="nv">next: </span><span class="nx">next</span>
    <span class="p">}</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-113" id="section-113">&#182;</a>
</div>
<p>Extra options</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="k">if</span> <span class="nx">ignoreHiddenFiles</span><span class="o">?</span>
      <span class="nv">scandirOptions.ignoreHiddenFiles = </span><span class="nx">ignoreHiddenFiles</span>
    <span class="k">if</span> <span class="nx">ignorePatterns</span><span class="o">?</span>
      <span class="nv">scandirOptions.ignorePatterns = </span><span class="nx">ignorePatterns</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-114" id="section-114">&#182;</a>
</div>
<p>Scan all the files in the diretory and copy them over asynchronously</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">scandir</span><span class="p">(</span><span class="nx">scandirOptions</span><span class="p">)</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-115" id="section-115">&#182;</a>
</div>
<p>Chain</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="nx">@</span>
  </pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-116" id="section-116">&#182;</a>
</div>
<p>Remove a directory
next(err)</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="nv">rmdir: </span><span class="nf">(parentPath,next) -&gt;</span>
    <span class="nx">pathUtil</span><span class="p">.</span><span class="nx">exists</span> <span class="nx">parentPath</span><span class="p">,</span> <span class="nf">(exists) -&gt;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-117" id="section-117">&#182;</a>
</div>
<p>Skip</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>      <span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">()</span>  <span class="nx">unless</span> <span class="nx">exists</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-118" id="section-118">&#182;</a>
</div>
<p>Remove</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>      <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">scandir</span><span class="p">(</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-119" id="section-119">&#182;</a>
</div>
<p>Path</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>        <span class="nx">parentPath</span>
        </pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-120" id="section-120">&#182;</a>
</div>
<p>File</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>        <span class="nf">(fileFullPath,fileRelativePath,next) -&gt;</span>
          <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">openFile</span> <span class="o">-&gt;</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">unlink</span> <span class="nx">fileFullPath</span><span class="p">,</span> <span class="nf">(err) -&gt;</span>
            <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">closeFile</span><span class="p">()</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-121" id="section-121">&#182;</a>
</div>
<p>Forward</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>            <span class="k">if</span> <span class="nx">err</span>
              <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&#39;balUtilPaths.rmdir: failed to remove the child file:&#39;</span><span class="p">,</span> <span class="nx">fileFullPath</span>
            <span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
        </pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-122" id="section-122">&#182;</a>
</div>
<p>Dir</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>        <span class="nf">(fileFullPath,fileRelativePath,next) -&gt;</span>
          <span class="nx">next</span><span class="o">?</span> <span class="kc">null</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="nf">(next) -&gt;</span>
            <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">openFile</span> <span class="o">-&gt;</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">rmdir</span> <span class="nx">fileFullPath</span><span class="p">,</span> <span class="nf">(err) -&gt;</span>
              <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">closeFile</span><span class="p">()</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-123" id="section-123">&#182;</a>
</div>
<p>Forward</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>              <span class="k">if</span> <span class="nx">err</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&#39;balUtilPaths.rmdir: failed to remove the child directory:&#39;</span><span class="p">,</span> <span class="nx">fileFullPath</span>
              <span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
        </pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-124" id="section-124">&#182;</a>
</div>
<p>Completed</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>        <span class="nf">(err,list,tree) -&gt;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-125" id="section-125">&#182;</a>
</div>
<p>Error</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>          <span class="k">if</span> <span class="nx">err</span>
            <span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">list</span><span class="p">,</span> <span class="nx">tree</span><span class="p">)</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-126" id="section-126">&#182;</a>
</div>
<p>Success</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>          <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">openFile</span> <span class="o">-&gt;</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">rmdir</span> <span class="nx">parentPath</span><span class="p">,</span> <span class="nf">(err) -&gt;</span>
            <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">closeFile</span><span class="p">()</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-127" id="section-127">&#182;</a>
</div>
<p>Forward</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>            <span class="k">if</span> <span class="nx">err</span>
              <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&#39;balUtilPaths.rmdir: failed to remove the parent directory:&#39;</span><span class="p">,</span> <span class="nx">parentPath</span>
            <span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">list</span><span class="p">,</span> <span class="nx">tree</span><span class="p">)</span>
      <span class="p">)</span>
    </pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-128" id="section-128">&#182;</a>
</div>
<p>Chain</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="nx">@</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-129" id="section-129">&#182;</a>
</div>
<p>Write tree
next(err)</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="nv">writetree: </span><span class="nf">(dstPath,tree,next) -&gt;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-130" id="section-130">&#182;</a>
</div>
<p>Group</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="nv">tasks = </span><span class="k">new</span> <span class="nx">balUtilFlow</span><span class="p">.</span><span class="nx">Group</span> <span class="nf">(err) -&gt;</span>
      <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-131" id="section-131">&#182;</a>
</div>
<p>Ensure Destination</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">ensurePath</span> <span class="nx">dstPath</span><span class="p">,</span> <span class="nf">(err) -&gt;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-132" id="section-132">&#182;</a>
</div>
<p>Checks</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>      <span class="k">if</span> <span class="nx">err</span>
        <span class="k">return</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">exit</span> <span class="nx">err</span>
      </pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-133" id="section-133">&#182;</a>
</div>
<p>Cycle</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>      <span class="k">for</span> <span class="nx">own</span> <span class="nx">fileRelativePath</span><span class="p">,</span> <span class="nx">value</span> <span class="k">of</span> <span class="nx">tree</span>
        <span class="o">++</span><span class="nx">tasks</span><span class="p">.</span><span class="nx">total</span>
        <span class="nv">fileFullPath = </span><span class="nx">pathUtil</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span> <span class="nx">dstPath</span><span class="p">,</span> <span class="nx">fileRelativePath</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^\/+/</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">)</span> <span class="p">)</span>
        <span class="k">if</span> <span class="k">typeof</span> <span class="nx">value</span> <span class="o">is</span> <span class="s">&#39;object&#39;</span>
          <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">writetree</span> <span class="nx">fileFullPath</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">completer</span><span class="p">()</span>
        <span class="k">else</span>
          <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">openFile</span> <span class="o">-&gt;</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">writeFile</span> <span class="nx">fileFullPath</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nf">(err) -&gt;</span>
            <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">closeFile</span><span class="p">()</span>
            <span class="k">if</span> <span class="nx">err</span>
              <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&#39;balUtilPaths.writetree: writeFile failed on:&#39;</span><span class="p">,</span><span class="nx">fileFullPath</span>
            <span class="k">return</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">complete</span> <span class="nx">err</span>
      </pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-134" id="section-134">&#182;</a>
</div>
<p>Empty?</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>      <span class="k">if</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">total</span> <span class="o">is</span> <span class="mi">0</span>
        <span class="nx">tasks</span><span class="p">.</span><span class="nx">exit</span><span class="p">()</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-135" id="section-135">&#182;</a>
</div>
<p>Return</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>      <span class="k">return</span>
    </pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-136" id="section-136">&#182;</a>
</div>
<p>Chain</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="nx">@</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-137" id="section-137">&#182;</a>
</div>
<p>Read path
Reads a path be it local or remote
next(err,data)</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="nv">readPath: </span><span class="nf">(filePath,next) -&gt;</span>
    <span class="k">if</span> <span class="sr">/^http/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">filePath</span><span class="p">)</span>
      <span class="nv">request = </span><span class="nx">require</span><span class="p">(</span><span class="s">&#39;request&#39;</span><span class="p">)</span>  <span class="nx">unless</span> <span class="nx">request</span>
      <span class="nx">request</span> <span class="nx">filePath</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="nx">response</span><span class="p">,</span><span class="nx">data</span><span class="p">)</span> <span class="o">=&gt;</span>
        <span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>  <span class="k">if</span> <span class="nx">err</span>
        <span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span><span class="nx">data</span><span class="p">)</span>
    <span class="k">else</span>
      <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">openFile</span> <span class="o">-&gt;</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span> <span class="nx">filePath</span><span class="p">,</span> <span class="nf">(err,data) -&gt;</span>
        <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">closeFile</span><span class="p">()</span>
        <span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>  <span class="k">if</span> <span class="nx">err</span>
        <span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span><span class="nx">data</span><span class="p">)</span>
    </pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-138" id="section-138">&#182;</a>
</div>
<p>Chain</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="nx">@</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-139" id="section-139">&#182;</a>
</div>
<p>Empty
Check if the file does not exist, or is empty
next(err,empty)</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="nv">empty: </span><span class="nf">(filePath,next) -&gt;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-140" id="section-140">&#182;</a>
</div>
<p>Check if we exist</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="nx">pathUtil</span><span class="p">.</span><span class="nx">exists</span> <span class="nx">filePath</span><span class="p">,</span> <span class="nf">(exists) -&gt;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-141" id="section-141">&#182;</a>
</div>
<p>Return empty if we don't exist</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>      <span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span><span class="kc">true</span><span class="p">)</span>  <span class="nx">unless</span> <span class="nx">exists</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-142" id="section-142">&#182;</a>
</div>
<p>We do exist, so check if we have content</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>      <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">openFile</span> <span class="o">-&gt;</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">stat</span> <span class="nx">filePath</span><span class="p">,</span> <span class="nf">(err,stat) -&gt;</span>
        <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">closeFile</span><span class="p">()</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-143" id="section-143">&#182;</a>
</div>
<p>Check</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>        <span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>  <span class="k">if</span> <span class="nx">err</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-144" id="section-144">&#182;</a>
</div>
<p>Return whether or not we are actually empty</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>        <span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span><span class="nx">stat</span><span class="p">.</span><span class="nx">size</span> <span class="o">is</span> <span class="mi">0</span><span class="p">)</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-145" id="section-145">&#182;</a>
</div>
<p>Chain</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="nx">@</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-146" id="section-146">&#182;</a>
</div>
<p>Is Path Older Than
Checks if a path is older than a particular amount of millesconds
next(err,older)
older will be null if the path does not exist</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="nv">isPathOlderThan: </span><span class="nf">(aPath,bInput,next) -&gt;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-147" id="section-147">&#182;</a>
</div>
<p>Handle mtime</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="nv">bMtime = </span><span class="kc">null</span>
    <span class="k">if</span> <span class="k">typeof</span> <span class="nx">bInput</span> <span class="o">is</span> <span class="s">&#39;number&#39;</span>
      <span class="nv">mode = </span><span class="s">&#39;time&#39;</span>
      <span class="nv">bMtime = </span><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">()</span> <span class="o">-</span> <span class="nx">bInput</span><span class="p">)</span>
    <span class="k">else</span>
      <span class="nv">mode = </span><span class="s">&#39;path&#39;</span>
      <span class="nv">bPath = </span><span class="nx">bInput</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-148" id="section-148">&#182;</a>
</div>
<p>Check if the path exists</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">empty</span> <span class="nx">aPath</span><span class="p">,</span> <span class="nf">(err,empty) -&gt;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-149" id="section-149">&#182;</a>
</div>
<p>If it doesn't then we should return right away</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>      <span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="kc">null</span><span class="p">)</span>  <span class="k">if</span> <span class="nx">empty</span> <span class="o">or</span> <span class="nx">err</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-150" id="section-150">&#182;</a>
</div>
<p>We do exist, so let's check how old we are</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>      <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">openFile</span> <span class="o">-&gt;</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">stat</span> <span class="nx">aPath</span><span class="p">,</span> <span class="nf">(err,aStat) -&gt;</span>
        <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">closeFile</span><span class="p">()</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-151" id="section-151">&#182;</a>
</div>
<p>Check</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>        <span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>  <span class="k">if</span> <span class="nx">err</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-152" id="section-152">&#182;</a>
</div>
<p>Prepare</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>        <span class="nv">compare = </span><span class="o">-&gt;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-153" id="section-153">&#182;</a>
</div>
<p>Time comparison</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>          <span class="k">if</span> <span class="nx">aStat</span><span class="p">.</span><span class="nx">mtime</span> <span class="o">&lt;</span> <span class="nx">bMtime</span>
            <span class="nv">older = </span><span class="kc">true</span>
          <span class="k">else</span>
            <span class="nv">older = </span><span class="kc">false</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-154" id="section-154">&#182;</a>
</div>
<p>Return result</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>          <span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span><span class="nx">older</span><span class="p">)</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-155" id="section-155">&#182;</a>
</div>
<p>Perform the comparison</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>        <span class="k">if</span> <span class="nx">mode</span> <span class="o">is</span> <span class="s">&#39;path&#39;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-156" id="section-156">&#182;</a>
</div>
<p>Check if the bPath exists</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>          <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">empty</span> <span class="nx">bPath</span><span class="p">,</span> <span class="nf">(err,empty) -&gt;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-157" id="section-157">&#182;</a>
</div>
<p>Return result if we are empty</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>            <span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="kc">null</span><span class="p">)</span>  <span class="k">if</span> <span class="nx">empty</span> <span class="o">or</span> <span class="nx">err</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-158" id="section-158">&#182;</a>
</div>
<p>It does exist so lets get the stat</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>            <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">openFile</span> <span class="o">-&gt;</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">stat</span> <span class="nx">bPath</span><span class="p">,</span> <span class="nf">(err,bStat) -&gt;</span>
              <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">closeFile</span><span class="p">()</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-159" id="section-159">&#182;</a>
</div>
<p>Check</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>              <span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>  <span class="k">if</span> <span class="nx">err</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-160" id="section-160">&#182;</a>
</div>
<p>Assign the outer bMtime variable</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>              <span class="nv">bMtime = </span><span class="nx">bStat</span><span class="p">.</span><span class="nx">mtime</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-161" id="section-161">&#182;</a>
</div>
<p>Perform the comparison</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>              <span class="k">return</span> <span class="nx">compare</span><span class="p">()</span>
        <span class="k">else</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-162" id="section-162">&#182;</a>
</div>
<p>We already have the bMtime</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>          <span class="k">return</span> <span class="nx">compare</span><span class="p">()</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-163" id="section-163">&#182;</a>
</div>
<p>Chain</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="nx">@</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-164" id="section-164">&#182;</a>
</div>
<p>=====================================
Export</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="nv">module.exports = </span><span class="nx">balUtilPaths</span>
</pre></div>
        </td>
      </tr>
  </tbody>
</table>
  </div>
</body>
</html>
